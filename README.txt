
--------------------------------Содержание----------------------------------------------

Опорная_сеть.exe | файл приложения

Папки:
output | папка для сохранения графиков и отчета в .xlsx формате
files | папка с исходными файлами
contours | папка с txt-файлами из координат контуров
conf_files | папка с конфигурационными файлами
	parameters.yml | пареметры расчета
	reservoir_properties.json  ГФХ свойства пластов


-------------------------------------------------------------------------------------

-----------------------------------Инструкция----------------------------------------

1) Подготовить исходный файл формата ".csv" с данными по скважинам месторождения.
Разделителем разряда чисел должна быть точка.
Можно использовать выгрузку из NGT Smart версии 5.8.2, либо из ГеоБД ArcGIS.
Названия имен скважин должно быть одинаковым во всех загрузочных файлах.
Для расчета важен порядок столбцов (наименования для выгрузки из NGT Smart):
	№ скважины
	Дата
	Характер работы
	Состояние
	Месторождение
	Объекты работы
	Куст
	Координата X
	Координата Y
	Координата забоя Х (по траектории)
	Координата забоя Y (по траектории)
	Дебит нефти (ТР), т/сут
	Дебит жидкости (ТР), м3/сут
	Приемистость (ТР), м3/сут
	Обводненность (ТР), % (объём)
	Способ эксплуатации
	Дебит природного газа, тыс.м3/сут
	Приемистость (по суточным), м3/сут
	Дебит конденсата газа, т/сут

Для выгрузки ГеоБД выгружаются все столбцы, но обязательно вместе с точками Т3 скважин.

*При необходимости учета уже выполненных исследований
подготовить выгрузку с историей ГДИС на фонде из NGT Smart формата ".xlsx".

*Также есть опция расчета опорной сети в пределах выделенных пользователем зон. 
Для этого требуется подготовить выгрузку отрисованных конутров из NGT Smart 
в ".txt" формате и поместить их в папку /contours.

2) Заполнить необходимые параметры расчета в конфигурационном файле parameters.yml в папке /conf_files.

	=== ПУТИ К ФАЙЛАМ ===
	--- data_file содержит путь к исходному файлу с данными
		пример: "files/Холмогорское_NGT.csv"
	--- gdis_file сожержит путь к файлу с данными по проведенным ГДИС
		пример: "files/Холмогорское_ГДИС.xlsx"
		Варианты значений: "files/Название_Файла.xlsx" - считывается файл с данными по ГДИС
				   "нет" - файл не считывается, ГДИС не учитываются
	--- property_file содержит путь к файлу с ГФХ по всем пластам
		пример: "files/Справочник PVT_2023_10.xlsx"
	--- exception_file содержит путь к файлу с исключаемыми скважинами(в случае перевода скважины
			   на другой объект или аварии), нет определенного формата. Необходимо, чтобы в
			   в файле был столбец с названиями исключаемых скважин
		пример: "files/Холмогорское_Исключения.xlsx"
		Варианты значений: "files/Название_Файла.xlsx" - считывается список исключаемых скважин
				   "нет" - исключаемых скважин нет

	=== ОПЦИИ В РАСЧЕТЕ ===
	--- list_order_fond содержит порядок фондов скважин (пьезометрический, нагнетательный, добывающий)
	     	Пример: пьез, наг, доб
	     	Варианты значения параметра могут варьироваться, но только с ключевыми словами пьез, наг, доб.
	Параметр определяет порядок расчета фондов скважин объекта месторождения для построения регулярной сети.

	--- calculation_scenario определяет сценарий расчета модуля: реглярная сеть или опорная.
		Пример: regular
		Варианты значения параметра: optimize - модуль производит расчет по сценарию с целью охватить
					                все добывающие скважины с помощью пьезометрических и нагнетательных
					     regular - модуль производит расчет регулярной сетки скважин, основываясь
						       на параметре list_order_fond и отрисовывает оптимальный охват площади
						       скважинами по фондам в указанном порядке

	--- gdis_option задается в годах. 
		Пример: 2
		Варианты значения параметра: "нет" - ГДИС в расчете не учитываются
					     "ДД.ММ.ГГГГ" - учитываются ГДИС проведенные после этой даты
	Параметр определяет, какой давности ГДИС из выгрузки будут учтены в расчете. 
	Данные исследованные скважины вместе со скважинами в их окружении будут исключены из расчета.
 	
	--- separation_by_years задается в годах. 
		Пример: 2 
		Рекомендуемые значения параметра: "нет", 1, 2
	Определяет количество лет, на которые нужно распределить доисследуемые скважины, попавшие в "слепые" зоны.
	То есть при домножении оптимального радиуса на коэффициент больше, чем limit_radius_coef, 
	появляются скважины изолированные от ислледуемой и требующие для более качественной сетки повторного замера
	на более близком расстоянии. Такие дополнительные замеры можно распределить на несколько лет.

	--- calc_option определяет критерий, по которому скважина считается попавшей в зону охвата исследованием
		Пример: True (оптимальное значение)
		Варианты значения параметра: True или False
	False - если попадает только забой
	True - скважина включается в зону, если процент ее траектории входит в эту зону
	Значение процента задается параметром percent

	--- percent параметр, задающий минимальный процент длины тректории скважины 
	для включения ее в зону охвата исследуемой скважины. 
		Пример: 70 (оптимальное значение)
	*ННС сразу же попадают в зону охвата, так как являются точками при расчете.
	
	-- horizon_count отбирает из данных скважины с заданными кол-вом объектов.
		Пример: 1
		Варианты значений параметра: 0 - учитывать скважины с любым кол-вом объектов,
					     1, 2, 3... - максимальное кол-во объектов для скважины

	=== ОСНОВНЫЕ ПАРАМЕТРЫ ===
	--- mult_coef список коэффициентов кратного увеличения оптимального радиуса исследования.
		Пример: [1, 1.5, 2, 2.5] (оптимальное значение)
 	В расчете для каждой зоны и пласта определяется свой оптимальный (минимальный) радиус исследования, 
	который можно увеличивать с помощью данного параметра. 
	Для каждого такого коэффициента производится отдельный расчет.
	
	--- limit_radius_coef ограничение на коэффициент увеличения радиуса исследования. 
		Пример: 1.5 (оптимальное значение)
	Все коэффициенты в списке больше ограничения, подаются на отдельный сценарий расчета,
	где будет учитываться дообследование скважин, попавших в "слепые" зоны.

 	--- min_length_horWell минимальная длина ствола горизонтальной скважины
		Пример: 150 (оптимальное значение)
	В расчете разделение на ННС и ГС происходит по длине ствола между точками T1 и T3
	
	--- water_cut значение обводненности, ниже которого скважины из добывающего фонда исключаются из
	построения опорной сети
		Пример: 70 (скважины в добывающем фонде с обводненностью ниже 70% будут исключены)
	
	--- fluid_rate значение дебита жидкости скважины, при превышении которого скважина не будет
	включена в опорную сеть
		Пример: 300 м3/сут

	--- percent_oilrate процент от среднего дебита по объекту для ограничения кол-ва добывающих скважин,
	    остановленных на исследования
		Пример: 50
		Рекомендуемое значение параметра: 50

	--- limit_oilrate параметр задается в т/сут, задающий дополнительное ограничение по дебиту добывающего фонда включения в
	расчет на формирование опорной/регулярной сетки скважин
		Пример: 10
		Варианты значений параметра: для учета параметра в расчете, параметр должен быть больше 0,
		либо 0. При значении 0 параметр учитываться не будет.

	=== РАСЧЕТ ОПТИМАЛЬНОГО РАДИУСА ОХВАТА ===
	--- max_distance максимальный радиус для последющего выделения скважин первого окружения
		Пример: 1000 (оптимальное значение)
	--- verticalWellAngle угол для обозначения зоны вертикальных скважин на карте в полярной системе координат
		Пример: 10 (оптимальное значение)
	--- MaxOverlapPercent максимальный процент перекрытия от общей длины скважины
		Пример: 20 (оптимальное значение)
	Критерий перекрытия для выделения скважин первого окружения
	--- angle_horizontalT1 угол расширения сектора для точки Т1 горизонтальной скважины
		Пример: 10 (оптимальное значение)
	--- angle_horizontalT3 угол расширения сектора для точки Т3 горизонтальной скважины
		Пример: 10 (оптимальное значение)

3) Запустить .exe файл и дождаться звершения расчета.

4) В папке /output/pictures будут находиться полученные в процессе расчета картинки, 
В папке /output сохранится .xlsx файл с отчетами по каждому контуру и кратким общим отчетом.

--------------------------------------The End---------------------------------------
